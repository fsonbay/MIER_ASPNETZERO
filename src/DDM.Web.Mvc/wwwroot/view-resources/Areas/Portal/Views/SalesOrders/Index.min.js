(function(){$(function(){function n(){s.ajax.reload()}function h(i){abp.message.confirm("",app.localize("AreYouSure"),function(r){r&&t.delete({id:i.id}).done(function(){n(!0);abp.notify.success(app.localize("SuccessfullyDeleted"))})})}var f=$("#SalesOrdersTable"),t=abp.services.app.salesOrders;$(".date-picker").datetimepicker({locale:abp.localization.currentLanguage.name,format:"L"});var i={create:abp.auth.hasPermission("Pages.SalesOrders.Create"),edit:abp.auth.hasPermission("Pages.SalesOrders.Edit"),"delete":abp.auth.hasPermission("Pages.SalesOrders.Delete")},c=new app.ModalManager({viewUrl:abp.appPath+"Portal/SalesOrders/CreateOrEditModal",scriptUrl:abp.appPath+"view-resources/Areas/Portal/Views/SalesOrders/_CreateOrEditModal.js",modalClass:"CreateOrEditSalesOrderModal"}),e=new app.ModalManager({viewUrl:abp.appPath+"Portal/SalesOrders/ViewsalesOrderModal",modalClass:"ViewSalesOrderModal"}),o=new app.ModalManager({viewUrl:abp.appPath+"Portal/SalesOrders/EditProductionStatusModal",scriptUrl:abp.appPath+"view-resources/Areas/Portal/Views/SalesOrders/_EditProductionStatusModal.js",modalClass:"EditProductionStatusModal"}),r=function(n){return n.data("DateTimePicker").date()==null?null:n.data("DateTimePicker").date().format("YYYY-MM-DDT00:00:00Z")},u=function(n){return n.data("DateTimePicker").date()==null?null:n.data("DateTimePicker").date().format("YYYY-MM-DDT23:59:59Z")},s=f.DataTable({paging:!0,serverSide:!0,processing:!0,listAction:{ajaxFunction:t.getAll,inputFilter:function(){return{filter:$("#SalesOrdersTableFilter").val(),numberFilter:$("#NumberFilterId").val(),minDateFilter:r($("#MinDateFilterId")),maxDateFilter:u($("#MaxDateFilterId")),minDeadlineFilter:r($("#MinDeadlineFilterId")),maxDeadlineFilter:u($("#MaxDeadlineFilterId")),customerNameFilter:$("#CustomerNameFilterId").val()}}},columnDefs:[{className:"control responsive",orderable:!1,render:function(){return""},targets:0},{width:120,targets:1,data:null,orderable:!1,autoWidth:!1,defaultContent:"",rowAction:{cssClass:"btn btn-brand dropdown-toggle",text:'<i class="fa fa-cog"><\/i> '+app.localize("Actions")+' <span class="caret"><\/span>',items:[{text:app.localize("View"),iconStyle:"far fa-eye mr-2",action:function(n){e.open({id:n.record.salesOrder.id})}},{text:app.localize("Edit"),iconStyle:"far fa-edit mr-2",visible:function(){return i.edit},action:function(n){document.location.href=abp.appPath+"Portal/SalesOrders/CreateOrEdit/"+n.record.salesOrder.id}},{text:app.localize("Delete"),iconStyle:"far fa-trash-alt mr-2",visible:function(){return i.delete},action:function(n){h(n.record.salesOrder)}}]}},{targets:2,data:"salesOrder.number",name:"number"},{targets:3,data:"salesOrder.date",name:"date",render:function(n){return n?moment(n).format("L"):""}},{targets:4,data:"salesOrder.deadline",name:"deadline",render:function(n){return n?moment(n).format("L"):""}},{targets:5,data:"customerName",name:"customerFk.name"},{targets:6,data:"salesOrder.notes",name:"notes"},{targets:7,data:"productionStatus",name:"productionStatusFK.name"},{targets:8,data:null,orderable:!1,defaultContent:"",rowAction:{element:$("<div/>").addClass("text-center").append($("<button/>").addClass("btn btn-outline-primary").attr("title",app.localize("EditProductionStatus")).text("Edit Status")).click(function(){var n=$(this).data().salesOrder.id;o.open({id:n})})}}]});$("#ShowAdvancedFiltersSpan").click(function(){$("#ShowAdvancedFiltersSpan").hide();$("#HideAdvancedFiltersSpan").show();$("#AdvacedAuditFiltersArea").slideDown()});$("#HideAdvancedFiltersSpan").click(function(){$("#HideAdvancedFiltersSpan").hide();$("#ShowAdvancedFiltersSpan").show();$("#AdvacedAuditFiltersArea").slideUp()});$("#CreateNewSalesOrderButton").click(function(){document.location.href=abp.appPath+"Portal/SalesOrders/CreateOrEdit"});abp.event.on("app.createOrEditSalesOrderModalSaved",function(){n()});$("#GetSalesOrdersButton").click(function(t){t.preventDefault();n()});$(document).keypress(function(t){t.which===13&&n()})})})();